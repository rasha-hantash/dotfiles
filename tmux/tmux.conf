# --- Prefix ---
set -g prefix C-a
unbind C-b
bind C-a send-prefix

# --- General ---
set -g mouse on
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"
set -g extended-keys always
set -as terminal-features 'xterm*:extkeys'

# --- Clipboard ---
# Always use tmux copy-mode for mouse selection (ignore app mouse capture)
bind -T root MouseDrag1Pane copy-mode -M
# On mouse release, copy selection to system clipboard via pbcopy
set -s copy-command 'pbcopy'
# Copy to clipboard on mouse release (highlight disappears, text is on clipboard)
bind -T copy-mode MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel 'pbcopy'
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel 'pbcopy'

# --- Pane borders (yellow) + dimming ---
# Border bg matches active pane so yellow lines look seamless against the focused pane.
# The tiny bg mismatch against inactive panes (#181825 vs #1e1e2e) is barely visible.
set -g pane-border-style 'fg=#f9e2af,bg=#1e1e2e'
set -g pane-active-border-style 'fg=#f9e2af,bg=#1e1e2e'
set -g window-style 'bg=#1e1e2e'
set -g window-active-style 'bg=#181825'

# --- Status bar (top, minimal) ---
set -g status-position top
set -g status-style 'bg=#1e1e2e fg=#cdd6f4'
set -g status-left '#[fg=#b4befe,bold] ccs #[fg=#45475a,nobold]â”‚ '
set -g status-left-length 20
set -g status-right '#[fg=#6c7086]%H:%M '
set -g status-justify left

# Window tabs in status bar
setw -g window-status-format '  #W '
setw -g window-status-current-format '  #W '
setw -g window-status-current-style 'bg=#fab387 fg=#1e1e2e bold'
setw -g window-status-style 'fg=#6c7086'
setw -g window-status-separator ''

# Messages
set -g message-style 'bg=#313244 fg=#cdd6f4'
set -g message-command-style 'bg=#313244 fg=#cdd6f4'

# --- Pane focus hotkeys ---
# Layout: .1 = claude (left), .2 = sidebar (top-right), .3 = terminal (bottom-right)
# Panes auto-respawn via remain-on-exit + pane-died hook (set in ccs script)
bind f select-pane -t :.1
bind s select-pane -t :.2
bind m select-pane -t :.3
bind d detach-client

# --- Layout ---
# Created explicitly by ccs start/new (not via hook, to ensure consistent sizing)
# Prevent accidental pane resizing via mouse drag (scroll + selection still work)
unbind -n MouseDrag1Border
